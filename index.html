<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Screenshot Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <h1>Screenshot Tool</h1>
    <div id="tabVisibilityWarning" class="warning-message">
      ‚ö†Ô∏è This tool works best in a separate browser window or an active browser
      tab.
    </div>

    <div id="baseUrlSection" class="card">
        <h2>1. Enter Base Client URL</h2>
        <div class="base-url-container">
             <label for="baseUrlInput" class="base-url-label">Base URL:</label>
             <input type="text" placeholder="http://localhost:8088/data/perspective/client/PROJECT_NAME" class="base-url-input" id="baseUrlInput">
             </div>
         <div id="baseUrlStatus" class="help-text" style="margin-top: 5px;"></div> </div>

    <div id="loginOptionSection" class="card login-option-section" style="display: none;"> <h2>2. Select Login Option</h2>
        <div class="input-row">
            <label>
                <input type="radio" name="loginOption" value="continueWithoutLogin" id="optionContinueWithoutLogin"> Continue without login
            </label>
            <label>
                <input type="radio" name="loginOption" value="login" id="optionLogin"> Login
            </label>
        </div>
    </div>

    <div id="loginSection" class="card" style="display: none;">
      </div>

    <div id="captureForm" style="display: none">
       <div class="card" id="url-input-container">
        <h2 id="urlInputTitle">3. Select Pages to Capture</h2>
        <div
          id="urlHelpText"
          class="help-text"
          style="margin-top: -15px; margin-bottom: 10px; display: none;" >
          Note that this is the home page with menu
        </div>
        <textarea
          id="urlList"
          placeholder="Enter URLs (one per line)"
          rows="5"
          style="display: none;" ></textarea>
        <div class="input-row screen-size-row" style="display: flex; align-items: center; gap: 15px;">
          <label style="margin-bottom: 0;">
            Screen Size:
            <select id="capturePreset">
              <option value="fullHD" selected>Full HD (1920x1080)</option>
              <option value="mobile">Mobile (375x812)</option>
              <option value="tablet">Tablet (768x1024)</option>
            </select>
          </label>
          <label style="margin-bottom: 0; font-weight: normal;" title="Attempt to capture the entire vertical height of the page at the selected width.">
            <input type="checkbox" id="fullPageCheckbox" style="margin-right: 5px;">Capture Full Page Height
          </label>
        </div>
        </div><div id="advancedOptions" class="advanced-section" style="display: none;"> <h3>Advanced Options</h3>
          <div class="input-row">
            <label title="Maximum time to wait before capturing the screenshot">
              Max Wait Time (sec):
              <input type="number" id="waitTime" value="5" min="1" max="120" />
            </label>
          </div>
          <div class="toolbar-options">
            <div class="checkbox-container">
              <input type="checkbox" id="includeToolbarButtons" checked />
              <label for="includeToolbarButtons">
                Include Header button interactions (generates additional
                screenshots)
              </label>
            </div>
            <div class="help-text">
              <small>
                When enabled, additional screenshots will be taken after
                clicking each toolbar button on every page
              </small>
            </div>
          </div>
          <div class="input-row">
            <label
              title="Actions to perform before capturing (JSON format)"
              style="display: block; width: 100%"
              id="actionsLabel"
            >
              Context Actions (JSON format):
            </label>
            <div id="actionsGenerationStatus" class="generation-status"></div>
            <textarea
              id="actionsField"
              placeholder="Generate or enter menu navigation actions in JSON format"
              rows="8"
              style="width: 100%"
            ></textarea>
            <div id="actionItemMessages" class="action-item-messages"></div>
          </div>
        </div>

      <div class="btn-container" id="buttonContainer">
        <button id="captureBtn" class="btn icon-btn" disabled title="Capture Screenshots">üì∏</button>
        <button id="retryFailedBtn" class="btn icon-btn" disabled title="Retry Failed URLs">üîÑ</button>
      </div>
      </div>

    <div id="progressOutput" style="display: none">
      <div id="progress" class="status-message"></div>
      <div class="progress-container">
        <div id="progressBar" class="progress-bar"></div>
      </div>
      <div class="card stats" id="stats" style="display: none !important;"> <p><strong>Total URLs:</strong> <span id="totalCount">0</span></p>
        <p><strong>Processed:</strong> <span id="processedCount">0</span></p>
        <p><strong>Failed:</strong> <span id="failedCount">0</span></p>
        <p><strong>Total Time Taken:</strong> <span id="totalTime">0s</span></p>
      </div>
      <div id="output" class="card">
           </div>
    </div>

    <iframe id="screenshotIframe"></iframe>

    <script type="module" src="js/index.js"></script>
  </body>
</html>